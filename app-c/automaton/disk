#!/usr/bin/env nu

let loop_id = 99;

$env.temp_diskname = "vdisk";
def "main mount" [--name (-n): string] {
  if ($name | str length) > 0 {
    sudo losetup $"/dev/loop($loop_id)" $"($name)";
    sudo mount $"/dev/loop($loop_id)" /mnt;
    echo $"($name) is mounted!"
    $env.temp_diskname = name;
  } else {
    echo "no disk name!";
  }
}

def "main umount" [] {
  sudo umount /mnt;
  sudo losetup -d $"/dev/loop($loop_id)";
  echo $"($env.temp_diskname) is umounted!"; 
}

def main [] {}
